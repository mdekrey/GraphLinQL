scenario: Query Execution
tests:
  - name: Unnamed simple query
    given:
      query: |
        {
          hero {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "hero": {
                    "name": "R2-D2"
                }
            }
        }
        
  - name: Unnamed simple query with operation type
    given:
      query: |
        query {
          hero {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "hero": {
                    "name": "R2-D2"
                }
            }
        }
        
  - name: Named simple query
    given:
      query: |
        query OverallHero {
          hero {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "hero": {
                    "name": "R2-D2"
                }
            }
        }

  - name: Parameterized Query on a Droid
    given:
      query: |
        {
          droid(id: "2000") {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "droid": {
                    "name": "C-3PO"
                }
            }
        }
        
  - name: Parameterized Query on a Human
    given:
      query: |
        {
          human(id: "1000") {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "human": {
                    "name": "Luke Skywalker"
                }
            }
        }
        
  - name: Renaming parameters on a Droid
    given:
      query: |
        {
          droid(id: "2000") {
            id
            droidName: name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "droid": {
                    "id": "2000",
                    "droidName": "C-3PO"
                }
            }
        }

  - name: Missing parameter on Droid
    given:
      query: |
        {
          droid {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
          "errors": [
            {
              "message": "Missing argument \u0022id\u0022 for field \u0022droid\u0022.",
              "errorCode": "missingArgument",
              "locations": [
                {
                  "Line": 2,
                  "Column": 2
                }
              ],
              "arguments": {
                "fieldName": "droid",
                "argument": "id"
              }
            }
          ]
        }

  - name: Parameterized Query with Variables on a Droid
    given:
      query: |
        query ($id: ID!) {
          droid(id: $id) {
            name
          }
        }
      variables:
        id: "2000"
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "droid": {
                    "name": "C-3PO"
                }
            }
        }

  - name: Search list results
    given:
      query: |
        {
          search(text: "Luke") {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "search": [{
                    "name": "Luke Skywalker"
                }]
            }
        }
        
  - name: Search list results with multiple matches
    given:
      query: |
        {
          search(text: "L") {
            name
          }
        }
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "search": [{
                    "name": "Luke Skywalker"
                }, {
                    "name": "Leia Organa"
                }]
            }
        }
        
  - name: Named multiple queries
    given:
      query: |
        query SpecificDroid ($id: ID!) {
          droid(id: $id) {
            name
          }
        }
        query OverallHero {
          hero {
            name
          }
        }
      operation: OverallHero
    when:
      execute: true
    then:
      match-result: |
        {
            "data": {
                "hero": {
                    "name": "R2-D2"
                }
            }
        }
